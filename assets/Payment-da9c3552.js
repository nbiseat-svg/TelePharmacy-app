import{o as F,j as e,p as M}from"./index-1a78f5cf.js";import{u as A,r as o,L as B}from"./vendor-d9bade96.js";import{u as I,a as U}from"./redux-e3095c52.js";import{P as t}from"./paymentService-ee27eb05.js";import{m as p}from"./animations-c3d91ae5.js";import"./i18n-b264d0aa.js";const q=()=>{const y=A(),C=I(),{showSuccess:P,showError:d}=F(),g=U(s=>s.cart),{cartItems:w,shippingAddress:N,paymentMethod:r}=g,m=w.reduce((s,u)=>s+u.qty*u.price,0),j=m>100?0:10,b=Number((.08*m).toFixed(2)),l=(m+j+b).toFixed(2),[a,S]=o.useState({cardNumber:"",cardName:"",expiryDate:"",cvv:"",email:"",phoneNumber:"",accountNumber:"",bankName:"",walletAddress:"",cryptoCurrency:"BTC"}),[n,v]=o.useState(!1),[h,x]=o.useState(""),[f,i]=o.useState("");o.useEffect(()=>{N.address||y("/checkout")},[y,N]);const c=s=>{const{name:u,value:T}=s.target;S(E=>({...E,[u]:T}))},k=()=>{if(r==="Credit Card"){if(!a.cardNumber||!a.cardName||!a.expiryDate||!a.cvv)return i("Please fill in all credit card details"),d("Please fill in all credit card details"),!1;if(!t.validateCreditCardNumber(a.cardNumber))return i("Invalid credit card number"),d("Invalid credit card number"),!1}else if(r==="PayPal"){if(!a.email)return i("Please enter your PayPal email"),d("Please enter your PayPal email"),!1}else if(r==="Mobile Money"){if(!a.phoneNumber)return i("Please enter your phone number"),d("Please enter your phone number"),!1}else if(r==="Bank Transfer"){if(!a.accountNumber||!a.bankName)return i("Please enter your bank account details"),d("Please enter your bank account details"),!1}else if(r==="Cryptocurrency"&&(!a.walletAddress||!a.cryptoCurrency))return i("Please enter your cryptocurrency wallet address"),d("Please enter your cryptocurrency wallet address"),!1;return!0},D=async()=>{if(k()){v(!0),i(""),x("Processing payment...");try{let s;r==="Credit Card"?s=await t.processCreditCardPayment({cardNumber:a.cardNumber,cardName:a.cardName,expiryDate:a.expiryDate,cvv:a.cvv},l):r==="PayPal"?s=await t.processPayPalPayment({email:a.email},l):r==="Mobile Money"?s=await t.processMobileMoneyPayment({phoneNumber:a.phoneNumber},l):r==="Bank Transfer"?s=await t.processBankTransferPayment({accountNumber:a.accountNumber,bankName:a.bankName},l):r==="Cryptocurrency"&&(s=await t.processCryptoPayment({walletAddress:a.walletAddress,currency:a.cryptoCurrency},l)),s.success&&(x(s.message),P("Payment processed successfully! Your order is being prepared."),C(M()),setTimeout(()=>{y("/orders")},2e3))}catch(s){i(s.message),d(`Payment failed: ${s.message}`),x(""),v(!1)}}};return e.jsx(p.div,{className:"payment-page",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:e.jsxs("div",{className:"payment-container",children:[e.jsxs(p.div,{className:"payment-header",initial:{y:-50,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},children:[e.jsx("h2",{children:"Secure Payment"}),e.jsxs("p",{children:["Complete your payment using ",r]})]}),e.jsxs("div",{className:"payment-content",children:[e.jsx("div",{className:"payment-form-section",children:e.jsxs(p.div,{className:"payment-section",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:[e.jsx("h3",{children:"Payment Information"}),r==="Credit Card"&&e.jsxs("div",{className:"payment-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"cardNumber",children:"Card Number"}),e.jsx("input",{type:"text",id:"cardNumber",name:"cardNumber",placeholder:"1234 5678 9012 3456",value:a.cardNumber,onChange:c,disabled:n}),a.cardNumber&&e.jsx("small",{className:"card-type",children:t.getCardType(a.cardNumber)})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"cardName",children:"Cardholder Name"}),e.jsx("input",{type:"text",id:"cardName",name:"cardName",placeholder:"John Doe",value:a.cardName,onChange:c,disabled:n})]}),e.jsxs("div",{className:"form-row",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"expiryDate",children:"Expiry Date"}),e.jsx("input",{type:"text",id:"expiryDate",name:"expiryDate",placeholder:"MM/YY",value:a.expiryDate,onChange:c,disabled:n})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"cvv",children:"CVV"}),e.jsx("input",{type:"password",id:"cvv",name:"cvv",placeholder:"123",value:a.cvv,onChange:c,disabled:n})]})]})]}),r==="PayPal"&&e.jsx("div",{className:"payment-form",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"PayPal Email"}),e.jsx("input",{type:"email",id:"email",name:"email",placeholder:"your@email.com",value:a.email,onChange:c,disabled:n})]})}),r==="Mobile Money"&&e.jsx("div",{className:"payment-form",children:e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",placeholder:"+1234567890",value:a.phoneNumber,onChange:c,disabled:n})]})}),r==="Bank Transfer"&&e.jsxs("div",{className:"payment-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"bankName",children:"Bank Name"}),e.jsx("input",{type:"text",id:"bankName",name:"bankName",placeholder:"Enter your bank name",value:a.bankName,onChange:c,disabled:n})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"accountNumber",children:"Account Number"}),e.jsx("input",{type:"text",id:"accountNumber",name:"accountNumber",placeholder:"Enter your account number",value:a.accountNumber,onChange:c,disabled:n})]})]}),r==="Cryptocurrency"&&e.jsxs("div",{className:"payment-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"cryptoCurrency",children:"Cryptocurrency"}),e.jsxs("select",{id:"cryptoCurrency",name:"cryptoCurrency",value:a.cryptoCurrency,onChange:c,disabled:n,children:[e.jsx("option",{value:"BTC",children:"Bitcoin (BTC)"}),e.jsx("option",{value:"ETH",children:"Ethereum (ETH)"}),e.jsx("option",{value:"USDT",children:"Tether (USDT)"}),e.jsx("option",{value:"USDC",children:"USD Coin (USDC)"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"walletAddress",children:"Wallet Address"}),e.jsx("input",{type:"text",id:"walletAddress",name:"walletAddress",placeholder:"Enter your wallet address",value:a.walletAddress,onChange:c,disabled:n})]}),e.jsxs("div",{className:"crypto-info",children:[e.jsxs("p",{children:["Send exactly ",l," USD worth of ",a.cryptoCurrency," to the wallet address above."]}),e.jsx("p",{children:"Transaction will be confirmed after 1 network confirmation."})]})]}),f&&e.jsx("div",{className:"error-message",children:f}),h&&e.jsx("div",{className:`payment-status ${h.includes("successful")?"success":""}`,children:h}),e.jsxs("div",{className:"payment-actions",children:[e.jsx("button",{className:"btn-primary",onClick:D,disabled:n,children:n?"Processing...":`Pay ${t.formatCurrency(l)}`}),e.jsx(B,{to:"/placeorder",className:"btn-secondary",children:"Back"})]})]})}),e.jsx("div",{className:"payment-summary",children:e.jsxs(p.div,{className:"summary-box",initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{delay:.4},children:[e.jsx("h3",{children:"Order Summary"}),e.jsxs("div",{className:"summary-details",children:[e.jsxs("div",{className:"summary-row",children:[e.jsx("span",{children:"Items"}),e.jsx("span",{children:t.formatCurrency(m)})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("span",{children:"Shipping"}),e.jsx("span",{children:t.formatCurrency(j)})]}),e.jsxs("div",{className:"summary-row",children:[e.jsx("span",{children:"Tax"}),e.jsx("span",{children:t.formatCurrency(b)})]}),e.jsxs("div",{className:"summary-row total",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{children:t.formatCurrency(l)})]})]}),e.jsxs("div",{className:"payment-method-info",children:[e.jsx("h4",{children:"Payment Method"}),e.jsx("p",{children:r})]}),e.jsxs("div",{className:"secure-payment",children:[e.jsx("div",{className:"secure-icon",children:"ðŸ”’"}),e.jsx("p",{children:"Secure SSL Encryption"})]})]})})]})]})})};export{q as default};
